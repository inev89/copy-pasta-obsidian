
# Look at Installed Apps

```
reg query HKEY_LOCAL_MACHINE\SOFTWARE
```

```
Get-ChildItem 'C:\Program Files', 'C:\Program Files (x86)' | ft Parent,Name,LastWriteTime
```

# A way to find weak folder/files permissions in the system is doing:

```
accesschk.exe /accepteula
```

## Find all weak folder permissions per drive.

```
accesschk.exe -uwdqs Users c:\
```

```
accesschk.exe -uwdqs "Authenticated Users" c:\
```

```
accesschk.exe -uwdqs "Everyone" c:\
```

## Find all weak file permissions per drive.

```
accesschk.exe -uwqs Users c:\*.*
```

```
accesschk.exe -uwqs "Authenticated Users" c:\*.*
```

```
accesschk.exe -uwdqs "Everyone" c:\*.*
```

```
icacls "C:\Program Files\*" 2>nul | findstr "(F) (M) :\" | findstr ":\ everyone authenticated users todos %username%"
```

```
icacls ":\Program Files (x86)\*" 2>nul | findstr "(F) (M) C:\" | findstr ":\ everyone authenticated users todos %username%"
```

```
Get-ChildItem 'C:\Program Files\*','C:\Program Files (x86)\*' | % { try { Get-Acl $_ -EA SilentlyContinue | Where {($_.Access|select -ExpandProperty IdentityReference) -match 'Everyone'} } catch {}}
```

```
Get-ChildItem 'C:\Program Files\*','C:\Program Files (x86)\*' | % { try { Get-Acl $_ -EA SilentlyContinue | Where {($_.Access|select -ExpandProperty IdentityReference) -match 'BUILTIN\Users'} } catch {}}
```

# hosts file

```
type C:\Windows\System32\drivers\etc\hosts
```